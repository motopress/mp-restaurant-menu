!function(e){"use strict";tinymce.PluginManager.add("mp_restaurant_menu",function(t,n){function a(){e("[name=shortcode_name]").off("change").on("change",function(){MP_RM_Registry._get("MP_RM_Functions").showBlocks(e(this).val())})}function i(){var t=e('[name="shortcode_name"]').val();if("mprm_items"===t){var n=e('[name="item_ids"],[name="feat_img"],select[name="categ_name"]'),a=e('input[name="categ_name"],[name="price_pos"]');switch(e('*[data-display="mprm_items"] select[name="view"]').val()){case"simple-list":n.parents(".mprm-line").addClass("hidden"),a.parents(".mprm-line").removeClass("hidden");break;case"grid":case"list":default:n.parents(".mprm-line").removeClass("hidden"),a.parents(".mprm-line").addClass("hidden")}}}function o(t){e("[data-selector=insert_shortcode]").off("click").on("click",function(){var n=r(e("[data-selector=shortcode-form]"));_.isFunction(t)&&t(n)})}function s(){e("[data-selector=shortcode-form]").find("input[type=checkbox]").off("change").on("change",function(){e(this).attr("checked")?e(this).val("1"):e(this).val("")})}function r(t){var n={attrs:{},name:""};return t.find("[data-selector=data-line]").each(function(t,a){if(e(a).is(":visible")){var i=e(a).find("[data-selector=form_data]");i.length&&!_.isNull(i.val())&&""!==i.val()&&(_.isArray(i.val())?n.attrs[i.attr("name")]=i.val().join(","):n.attrs[i.attr("name")]=i.val())}}),n.name=e("[data-selector=shortcode_name]").val(),n}var c="Insert Restaurant Menu Shortcode";t.addButton("mp_add_menu",{title:c,image:n+"/../img/shortcode-icon.png",onclick:function(){MP_RM_Registry._get("MP_RM_Functions").callModal("",function(){var n=this;MP_RM_Registry._get("MP_RM_Functions").wpAjax({controller:"popup",action:"get_shortcode_builder"},function(r){n.setContent(r),MP_RM_Registry._get("MP_RM_Functions").showBlocks("mprm_categories"),a(),s(),i(),e("#mprm-shortcode-form").on("change",'*[data-display="mprm_items"] select[name="view"]',i),e("#mprm-shortcode-form").on("change",'select[name="shortcode_name"]',i),o(function(e){var a=wp.shortcode.string({tag:e.name,attrs:e.attrs,type:"single"});t.insertContent(a),n.close()})},function(e){console.warn(e)})},{title:c,width:500,height:600})}})})}(window.jQuery);