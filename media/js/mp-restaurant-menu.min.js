window.MP_RM_Registry=function(){"use strict";function e(e){return e.getInstance&&"function"==typeof e.getInstance?!0:!1}function t(t,n){if(!e(n))throw new Error('Invalide module "'+t+'". The function "getInstance" is not defined.');a[t]=n}function n(t){for(var n in t)if(t.hasOwnProperty(n)){if(!e(t[n]))throw new Error('Invalide module "'+n+'" inside the collection. The function "getInstance" is not defined.');a[n]=t[n]}}function r(e){delete a[e]}function i(e){var t=a[e];if(!t)throw new Error('The module "'+e+'" has not been registered or it was unregistered.');if("function"!=typeof t.getInstance)throw new Error('The module "'+e+'" can not be instantiated. The function "getInstance" is not defined.');return a[e].getInstance()}var a={};return{register:t,unregister:r,_get:i,MP_RM_RegistryMap:n}}(),MP_RM_Registry.register("MP_RM_Functions",function(e){"use strict";function t(){return{init:function(){},wpAjax:function(e,t,n){e.mprm_action=e.action,delete e.action,wp.ajax.send("route_url",{success:function(e){!_.isUndefined(n)&&_.isFunction(n)&&t(e)},error:function(e){!_.isUndefined(n)&&_.isFunction(n)?n(e):console.log(e)},data:e})},getParameterByName:function(e,t){for(var n,r=[],i=e.slice(e.indexOf("?")+1).split("&"),a=0;a<i.length;a++)n=i[a].split("="),r.push(n[0]),r[n[0]]=n[1];return"undefined"!=typeof t?r[t]:r},callTooltip:function(e,t,n){_.isUndefined(n)&&(n=5),_.isUndefined(e)&&console.warn("Parameter 'selector' not find"),_.isUndefined(t)&&console.warn("Parameter 'text' not find");var r=new jBox("Tooltip",{content:t,target:e,closeOnEsc:!0,adjustPosition:"flip",adjustTracker:!0,reposition:!0,closeOnClick:"body",maxWidth:200,onOpen:function(){n>0&&setTimeout(function(){r.close()},1e3*n)}});return r.open(),r},callModal:function(t,n,r){t=_.isEmpty(t)?o:t;var i=e(window).outerHeight()-60,a=e(window).outerWidth()-60,o=wp.html.string({tag:"span",attrs:{"class":"spinner is-active"},content:""}),m={content:t,closeOnEsc:!0,animation:{open:"zoomIn",close:"zoomOut"},width:a,height:i,closeButton:"box",addClass:"mprm-modal",onOpen:function(){var t=e("#"+this.id);n.call(this,t)},onClose:function(){e("#"+this.id).remove()}};_.isUndefined(r)||e.extend(m,r);var s=new jBox("Modal",m);s.open()},callNotice:function(e,t,n){var r,i={};switch(t){case"done":r="green";break;case"error":r="red";break;default:r="green"}_.isEmpty(n)&&(n=3),e=_.isEmpty(e)?"":e;var a=new jBox("Notice",{content:e,color:r,theme:"NoticeBorder",attributes:{x:"left",y:"bottom"},animation:{open:"slide:bottom",close:"slide:left"},onOpen:function(){i=this,setTimeout(function(){i.close()},1e3*n)}});a.open()},showBlocks:function(e,t){n.doActionForObj(e,t,"show")},showSomeBlock:function(e,t){n.doActionForObj(e,t,"some-show")},hideBlocks:function(e,t){n.doActionForObj(e,t,"hide")},doActionForObj:function(t,r,i){_.isUndefined(i)&&(i="show");var a,o=!1,m=!1;a=_.isUndefined(r)?e("[data-display]"):r.find("[data-display]"),a.each(function(){var r,s=e(this),c=[],d=s.attr("data-display").split(",");if(e.each(d,function(t,n){d[t]=e.trim(n)}),r=t.split(","),e.each(r,function(t,r){e.extend(c,n.inArray(d,r))}),!_.isEmpty(c)){switch(o||"show"!==i||(a.addClass("hidden"),o=!0),i){case"show":case"some-show":s.removeClass("hidden");break;case"hide":s.addClass("hidden")}m=!0}}),m||console.warn("The element with attribute 'data-display = "+t+"' is not find")},inArray:function(t,n){var r=[],i=e.inArray(n,t);return i>=0&&r.push(t[i]),r},validateForm:function(t){if(t){var n=e("#"+t),r=document.getElementById(t);return"function"==typeof r.checkValidity&&!1===r.checkValidity()?(n.find(":invalid").addClass("mprm-form-error"),n.find("input").each(function(){this.validity.valid||e(this).focus()}),e("input",n).off("keypress").on("keypress",function(t){var n=e(this).attr("type");/date|email|month|number|search|tel|text|time|url|week/.test(n)&&13==t.keyCode||e(this).removeClass("mprm-form-error")}),!1):!0}return!1}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("HtmlBuilder",function(e){"use strict";function t(){return{_singleHtmlTag:{tag:"div",attrs:{id:356,"class":"item","data-selector":"some-button"},content:"<%= data-key %>"},_htmlStructure:{tag:"div",attrs:{id:356,"class":"item","data-selector":"some-button"},content:{tag:"div",attrs:{"class":"title"},content:"<%= data-key %>"}},_htmlStructureWithArray:{tag:"div",attrs:{id:356,"class":"item","data-selector":"some-button"},content:[{tag:"div",attrs:{"class":"title"},content:"<%= data-key %>"},{tag:"span",attrs:{"class":"date"},content:"<%= data-key %>"}]},generateHTML:function(t){var r,i="";if(_.isObject(t)){var a=document.createElement(t.tag);_.isUndefined(t.attrs)||e.each(t.attrs,function(e,t){a.setAttribute(e,t)}),_.isArray(t.content)?(e.each(t.content,function(e,t){i+=n.generateHTML(t)}),e(a).html(i)):_.isObject(t.content)?(i=n.generateHTML(t.content),e(a).html(i)):e(a).html(_.isUndefined(t.content)?"":t.content),r=e(a).get(0).outerHTML}else r=_.isString(t)?t:!1;return r},getHtml:function(t,r){if(_.isUndefined(t))return!1;var i=!1;if(_.isUndefined(r)&&(_.isArray(t)?(i="",e.each(t,function(e,t){i+=n.generateHTML(t)})):i=n.generateHTML(t)),_.isObject(r)){var a=_.template(i);i=a(r)}return i}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Menu-Shop",function(e){"use strict";function t(){return{init:function(){},addToCart:function(){e(".mprm-add-to-cart.mprm-has-js").on("click",function(t){t.preventDefault();var n=e(this),r=n.closest("form"),i=r.serializeArray();i.push({name:"is_ajax",value:!0}),e(".widget_mprm_cart_widget").length&&i.push({name:"cart",value:!0}),MP_RM_Registry._get("MP_RM_Functions").wpAjax(i,function(t){r.find(".mprm_go_to_checkout").show(),r.find(".mprm-add-to-cart").hide(),e(".widget_mprm_cart_widget .mprm-cart-content").html(t.cart),t.redirect?window.location=t.redirect:(e(".mprm-cart-added-alert",r).fadeIn(),setTimeout(function(){e(".mprm-cart-added-alert",r).fadeOut()},3e3))},function(e){console.warn("Some error!!!"),console.warn(e)})})},changeGateway:function(){e("input[name=payment-mode]","#mprm_purchase_form").on("change",function(){e("#mprm_purchase_form_wrap").html(""),n.loadGateway()})},loadGateway:function(){var t=e("input[name=payment-mode]:checked","#mprm_purchase_form").val();if(t){var r=[{name:"controller",value:"cart"},{name:"mprm_action",value:"load_gateway"},{name:"payment-mode",value:t}];e(".mprm-cart-ajax").show(),MP_RM_Registry._get("MP_RM_Functions").wpAjax(r,function(t){e(".mprm-no-js:not(.mprm-add-to-cart)").hide(),e("#mprm_purchase_form_wrap").html(t.html),n.showTerms()},function(e){console.warn("Some error!!!"),console.warn(e)})}},update_item_quantities:function(){e(".mprm-item-quantity").on("change",function(){var t=e(this),n=t.val(),r=t.data("key"),i=t.closest(".mprm_cart_item").data("menu-item-id"),a=t.parent().find('input[name="mprm-cart-menu-item-'+r+'-options"]').val(),o={action:"update_cart_item_quantity",controller:"cart",quantity:n,menu_item_id:i,options:a};MP_RM_Registry._get("MP_RM_Functions").wpAjax(o,function(t){e(".mprm_cart_subtotal_amount").each(function(){var n=e(this);n.text(t.subtotal),n.attr("data-subtotal",t.subtotal),n.attr("data-total",t.subtotal)}),e(".mprm_cart_tax_amount").each(function(){e(this).text(t.taxes)}),e(".mprm_cart_amount").each(function(){var n=e(this);n.text(t.total),n.attr("data-subtotal",t.total),n.attr("data-total",t.total)})},function(e){console.warn("Some error!!!"),console.warn(e)})})},removeFromCart:function(){},purchaseForm:function(){e(document).on("click","#mprm_purchase_form #mprm_purchase_submit input[type=submit]",function(t){var n=e(this).parents("form");if(!n.hasClass("mprm-no-js")){var r=document.getElementById("mprm_purchase_form");e(r);if(!MP_RM_Registry._get("MP_RM_Functions").validateForm("mprm_purchase_form"))return;t.preventDefault(),e(this).after('<span class="mprm-cart-ajax"><i class="mprm-icon-spinner mprm-icon-spin"></i></span>');var i=e(r).serializeArray();e.each(i,function(e,t){t&&"mprm_action"==t.name&&"gateway_select"==t.value&&i.splice(e,1)}),e(".mprm-cart-ajax").show(),e(".mprm-errors").remove(),MP_RM_Registry._get("MP_RM_Functions").wpAjax(i,function(t){t.errors?e("#mprm_final_total_wrap").before(t.errors):e("#mprm_purchase_form").submit()},function(t){t.error&&e("#mprm_final_total_wrap").before(t.errors),e(".mprm-cart-ajax").remove(),console.warn("Some error!!!"),console.warn(t)})}})},showTerms:function(){e("#mprm_show_terms .mprm_terms_links").on("click",function(t){t.preventDefault(),e(this).parents("#mprm_show_terms").find(".mprm_terms_links").toggle(),e("#mprm_terms").toggle()})},get_login:function(){e("#mprm_checkout_form_wrap").on("click",".mprm_checkout_register_login",function(t){t.preventDefault();var n=(e(this),{action:"get_login",controller:"customer"});MP_RM_Registry._get("MP_RM_Functions").wpAjax(n,function(t){e("#mprm_checkout_form_wrap").html(t.html)},function(e){console.warn("Some error!!!"),console.warn(e)})})},loginAjax:function(){e("#mprm_checkout_form_wrap").on("click",'#mprm_login_submit,[name="mprm_login_submit"]',function(t){t.preventDefault(),e(".mprm-errors").remove();var n={action:"login_ajax",controller:"customer",nonce:e('[name="mprm_login_nonce"]').val(),redirect:e('[name="redirect"]').val(),pass:e('[name="mprm_user_pass"]').val(),login:e('[name="mprm_user_login"]').val()};MP_RM_Registry._get("MP_RM_Functions").wpAjax(n,function(e){e.redirect?window.location=e.redirect_url:window.location.reload()},function(t){t.data.html?e("#mprm_checkout_form_wrap .mprm-login-fields").after(t.data.html):(console.warn("Some error!!!"),console.warn(t))})})}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Order",function(e){"use strict";function t(){return{init:function(){n.hideElementOrder(),n.addComment(),n.removeComment(),n.initChosen(),n.addCustomer(),n.removeMenuItem(),n.addMenuItem(),n.recalculate_total(),n.changeOrderBaseCountry(),n.changeCustomer()},changeOrderBaseCountry:function(){e("[name='mprm_settings[base_state]'] option").length<1&&e("[name='mprm_settings[base_state]']").parents("tr").hide(),e("select.mprm-country-list").on("change",function(){var t={action:"get_state_list",controller:"settings",country:e(this).val()},n=e(this).parents(".mprm-columns.mprm-four"),r=n.find("select.mprm-country-state");MP_RM_Registry._get("MP_RM_Functions").wpAjax(t,function(t){r.parents("#mprm-order-address-state-wrap").hide(),e.isEmptyObject(t)?r.parents("#mprm-order-address-state-wrap").hide():(r.find("option").remove(),e.each(t,function(t,n){r.append(e("<option>").text(n).attr("value",t))}),r.trigger("chosen:updated"),r.parents("#mprm-order-address-state-wrap").show())},function(e){console.warn("Some error!!!"),console.warn(e)})})},addComment:function(){e("#mprm-add-order-note").on("click",function(t){t.preventDefault();var r={action:"add_comment",controller:"order",order_id:e(this).attr("data-order-id"),noteText:e("#mprm-order-note").val()};MP_RM_Registry._get("MP_RM_Functions").wpAjax(r,function(t){e(".mprm-no-order-notes").hide(),e("#mprm-order-notes-inner").append(t.html),e("#mprm-order-note").val(""),n.removeComment()},function(e){console.warn("Some error!!!"),console.warn(e)})})},addMenuItem:function(){e('[name="mprm-order-menu-item-select"]').on("change",function(){var t={action:"get_price",controller:"menu_item",menu_item:e(this).val()};MP_RM_Registry._get("MP_RM_Functions").wpAjax(t,function(t){e('[name="mprm-order-menu-item-amount"]').val(t.price)},function(e){console.warn("Some error!!!"),console.warn(e)})}),e("#mprm-order-add-menu-item").on("click",function(t){t.preventDefault();var n=e('[name="mprm-order-menu-item-select"]'),r=e("#mprm-order-menu-item-quantity"),i=e('[name="mprm-order-menu-item-amount"]'),a=n.val(),o=e('[name="mprm-order-menu-item-select"] option:selected').text(),m=r.val(),s=i.val(),c=0,d=!1;if(1>a)return!1;if(s||(s=0),s=parseFloat(s),isNaN(s))return alert(mprm_admin_vars.numeric_item_price),!1;var u=s;if("1"===mprm_admin_vars.quantities_enabled){if(isNaN(parseInt(m)))return alert(mprm_admin_vars.numeric_quantity),!1;s*=m}s=s.toFixed(mprm_admin_vars.currency_decimals);var l=s+mprm_admin_vars.currency_sign;"before"===mprm_admin_vars.currency_pos&&(l=mprm_admin_vars.currency_sign+s),d&&(o=o+" - "+d);var p=e(".mprm-row.item").length,_=e("#mprm-purchased-wrapper .mprm-row.item:last").clone();_.find(".menu_item span").html('<a href="post.php?post='+a+'&action=edit"></a>'),_.find(".item span a").text(o),_.find(".price-text").text(l),_.find(".item-quantity").text(m),_.find(".item-price").text(mprm_admin_vars.currency_sign+(s/m).toFixed(mprm_admin_vars.currency_decimals)),_.find("input.mprm-order-detail-id").val(a),_.find("input.mprm-order-detail-price-id").val(c),_.find("input.mprm-order-detail-item-price").val(u),_.find("input.mprm-order-detail-amount").val(s),_.find("input.mprm-order-detail-quantity").val(m),_.find("input.mprm-order-detail-has-log").val(0),_.find("input").each(function(){var t=e(this).attr("name");t=t.replace(/\[(\d+)\]/,"["+parseInt(p)+"]"),e(this).attr("name",t).attr("id",t)}),e("#mprm-payment-menu-items-changed").val(1),e(_).insertAfter("#mprm-purchased-wrapper .mprm-row.item:last"),e(".mprm-order-recalc-totals").show()})},recalculate_total:function(){e("#mprm-order-recalc-total").on("click",function(t){t.preventDefault();var n=0,r=e("#mprm-purchased-wrapper .mprm-row.item .mprm-order-detail-amount");r.length&&r.each(function(){n+=parseFloat(e(this).val())}),e(".mprm-order-fees").length&&e(".mprm-order-fees span.fee-amount").each(function(){n+=parseFloat(e(this).data("fee"))}),e('input[name="mprm-order-total"]').val(n.toFixed(mprm_admin_vars.currency_decimals)),e(".mprm-order-recalc-totals").hide()})},removeMenuItem:function(){e(".mprm-order-remove-menu-item.mprm-delete").on("click",function(t){t.preventDefault();var n=e(document.body).find("#mprm-purchased-wrapper > .mprm-row").length;if(1===n)return alert(mprm_admin_vars.one_menu_item_min),!1;if(confirm(mprm_admin_vars.delete_payment_menu_item)){var r=e(this).data("key"),i=e('input[name="mprm-order-details['+r+'][id]"]').val(),a=e('input[name="mprm-order-details['+r+'][price_id]"]').val(),o=e('input[name="mprm-order-details['+r+'][quantity]"]').val(),m=e('input[name="mprm-order-details['+r+'][amount]"]').val(),s=e('input[name="mprm-order-removed"]').val();s=e.parseJSON(s),s.length<1&&(s={});var c=[{id:i,price_id:a,quantity:o,amount:m,cart_index:r}];s[r]=c,e('input[name="mprm-order-removed"]').val(JSON.stringify(s)),e(this).parents(".mprm-row").remove(),e("#mprm-order-menu-items-changed").val(1),e(".mprm-order-recalc-totals").show()}return!1}),e("#mprm-purchased-wrapper").on("click",".mprm-order-remove-menu-item",function(){console.log("X")})},changeCustomer:function(){e('[name="customer-id"]').on("change",function(){var t={action:"get_customer_information",controller:"customer",customer_id:e(this).val()};MP_RM_Registry._get("MP_RM_Functions").wpAjax(t,function(t){e(".mprm-customer-information").html(t.customer_information)},function(e){console.warn("Some error!!!"),console.warn(e)})})},addCustomer:function(){e(".mprm-new-customer").on("click",function(){e(".customer-info.mprm-row").hide(),e(".new-customer.mprm-row").show(),e('[name="mprm-new-customer"]').val(1)}),e(".mprm-new-customer-cancel").on("click",function(){e(".customer-info.mprm-row").show(),e(".new-customer.mprm-row").hide(),e('[name="mprm-new-customer"]').val(0)}),e(".mprm-new-customer-save").on("click",function(t){t.preventDefault();var n={action:"add_customer",controller:"customer",name:e('[name="mprm-new-customer-name"]').val(),email:e('[name="mprm-new-customer-email"]').val(),phone:e('[name="mprm-new-phone-number"]').val()};MP_RM_Registry._get("MP_RM_Functions").wpAjax(n,function(t){e(".customer-info.mprm-row").show(),e(".new-customer.mprm-row").hide(),e('[name="customer-id"]').replaceWith(t.html),e(".mprm-customer-information").html(t.customer_information)},function(t){e(".customer-info.mprm-row").show(),e(".new-customer.mprm-row").hide(),console.warn("Some error!!!"),console.warn(t)})})},initChosen:function(){var t=e(".mprm-select-chosen");t.length&&e.each(t,function(t,n){var r="undefined"!=typeof e(this).attr("data-text_single")?e(this).attr("data-text_single"):mprm_admin_vars.one_option,i="undefined"!=typeof e(this).attr("data-text_multiple")?e(this).attr("data-text_multiple"):mprm_admin_vars.one_or_more_option;e(this).chosen({inherit_select_classes:!0,placeholder_text_single:r,placeholder_text_multiple:i})})},removeComment:function(){e(".mprm-delete-order-note").off("click").on("click",function(t){t.preventDefault();var n=e(this).attr("data-note-id"),r={action:"remove_comment",controller:"order",order_id:e(this).attr("data-order-id"),note_id:n};MP_RM_Registry._get("MP_RM_Functions").wpAjax(r,function(t){e("#mprm-payment-note-"+n).remove(),e(".mprm-payment-note").length<1&&e(".mprm-no-order-notes").show()},function(e){console.warn("Some error!!!"),console.warn(e)})})},hideElementOrder:function(){e("#submitdiv").hide(),e("#order-log").hide(),e("#titlewrap").parents("#post-body-content").hide(),e("#commentstatusdiv").parent().hide(),e("#post_status").find("option").remove(),e('select[name="mprm-order-status"]').find("option").clone().appendTo(e("#post_status"))}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Menu-Settings",function(e){"use strict";function t(){return{init:function(){e("#rm_settings").on("submit",function(){var t=e(this).serializeArray();return e("#setting-error-settings_updated:visible").remove(),n.saveSettings(t,function(t){var n=e("#setting-error-settings_updated").clone();n.removeClass("hidden"),e(".wrap #settings-title").after(n),e(".notice-dismiss").on("click",function(){e(this).parent().remove()})}),!1}),n.changeBaseCountry(),n.settingsUpload()},saveSettings:function(e,t){MP_RM_Registry._get("MP_RM_Functions").wpAjax(e,function(e){!_.isUndefined(t)&&_.isFunction(t)&&t(e)},function(e){console.warn("Some error!!!"),console.warn(e)})},delete_checked:function(){e("#mprm-customer-delete-confirm").change(function(){var t=e("#mprm-customer-delete-records"),n=e("#mprm-delete-customer");e(this).prop("checked")?(t.attr("disabled",!1),n.attr("disabled",!1)):(t.attr("disabled",!0),t.prop("checked",!1),n.attr("disabled",!0))})},settingsUpload:function(){if("undefined"==typeof wp||"1"!==mprm_admin_vars.new_media_ui){var t=e(".mprm_settings_upload_button");t.length>0&&(window.formfield="",e(document.body).on("click",t,function(t){t.preventDefault(),window.formfield=e(this).parent().prev(),window.tbframe_interval=setInterval(function(){jQuery("#TB_iframeContent").contents().find(".savesend .button").val(mprm_admin_vars.use_this_file).end().find("#insert-gallery, .wp-post-thumbnail").hide()},2e3),tb_show(mprm_admin_vars.add_new_menu_item,"media-upload.php?TB_iframe=true")}),window.mprm_send_to_editor=window.send_to_editor,window.send_to_editor=function(t){if(window.formfield){var n=e("a","<div>"+t+"</div>").attr("href");window.formfield.val(n),window.clearInterval(window.tbframe_interval),tb_remove()}else window.mprm_send_to_editor(t);window.send_to_editor=window.mprm_send_to_editor,window.formfield="",window.imagefield=!1})}else{var n;window.formfield="",e(document.body).on("click",".mprm_settings_upload_button",function(t){t.preventDefault();var r=e(this);return window.formfield=e(this).parent().prev(),n?void n.open():(n=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",title:r.data("uploader_title"),button:{text:r.data("uploader_button_text")},multiple:!1}),n.on("menu:render:default",function(e){var t={};e.unset("library-separator"),e.unset("gallery"),e.unset("featured-image"),e.unset("embed"),e.set(t)}),n.on("insert",function(){var e=n.state().get("selection");e.each(function(e,t){e=e.toJSON(),window.formfield.val(e.url)})}),void n.open())});var n;window.formfield=""}},changeBaseCountry:function(){e("[name='mprm_settings[base_state]'] option").length<1&&e("[name='mprm_settings[base_state]']").parents("tr").hide(),e("[name='mprm_settings[base_country]']").on("change",function(){var t={action:"get_state_list",controller:"settings",country:e(this).val()},n=e(this).closest("tr"),r=n.next().find("select");MP_RM_Registry._get("MP_RM_Functions").wpAjax(t,function(t){e.isEmptyObject(t)?n.next().hide():(n.next().show(),r.remove("option"),e.each(t,function(t,n){r.append(e("<option>").text(n).attr("value",t))}))},function(e){console.warn("Some error!!!"),console.warn(e)})})}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Menu-Item",function(e){"use strict";function t(){return{imgIds:[],init:function(){n.imagesInit(),e("a.mp_menu_gallery").on("click",function(){n.openMediaWindow()})},imagesInit:function(){e(".mp_menu_images a.mprm-delete").off("click").on("click",function(){return e(this).parents("li.mprm-image").remove(),n.refreshImages(),!1}),n.refreshImages(),e("#mprm-menu-item-gallery .mp_menu_images").sortable({items:"li.mprm-image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"mp-metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style")},update:function(){n.refreshImages()}})},isNewImg:function(t){var n=e('.mp_menu_images li.mprm-image[data-key="'+t+'"]');return parseInt(n.attr("new_image"))?!0:!1},openMediaWindow:function(){if(void 0===this.window){this.window=wp.media({title:window.mprm_admin_vars.insert_media,library:{type:"image"},multiple:!0,button:{text:window.mprm_admin_vars.insert}});var t=this;this.window.on("select",function(){var r=t.window.state().get("selection").toJSON();e("#mprm-menu-item-gallery .mp_menu_images").append(n._buildImages(r)),n.imagesInit()})}return this.window.open(),!1},refreshImages:function(){var t=[];e("#mprm-menu-item-gallery .mp_menu_images li.mprm-image").each(function(n,r){t[n]=e(r).attr("data-attachment_id"),e(r).attr("data-key",n)}),e('#mprm-menu-item-gallery input[name="mp_menu_gallery"]').val(t.join(","))},_buildImages:function(t){var n=[];e.each(t,function(e,t){n.push({tag:"li",attrs:{"class":"mprm-image","data-attachment_id":t.id,new_image:1},content:[{tag:"img",attrs:{src:t.sizes.thumbnail.url}},{tag:"ul",attrs:{"class":"mprm-actions"},content:[{tag:"li",content:[{tag:"a",attrs:{"class":"mprm-delete",title:window.mprm_admin_vars.delete_img,href:"#"},content:window.mprm_admin_vars["delete"]}]}]}]})});try{return MP_RM_Registry._get("HtmlBuilder").getHtml(n)}catch(r){console.log(r)}},removeImg:function(t,n){var r={controller:"menu_item",action:"delete_gallery_img"};e.extend(r,t),MP_RM_Registry._get("MP_RM_Functions").wpAjax(r,function(e){!_.isUndefined(n)&&_.isFunction(n)&&n(e)},function(e){console.warn("Some error!!!"),console.warn(e)})},quickEdit:function(){e(document).on("click","#the-list .editinline",function(t){var n=e(this).closest("tr"),r=n.attr("id").replace(/\D/gi,""),i=n.find(".mprm-data-price").text(),a=n.find(".mprm-data-sku").text(),o=n.find(".mprm-data-calories").text(),m=n.find(".mprm-data-cholesterol").text(),s=n.find(".mprm-data-fiber").text(),c=n.find(".mprm-data-sodium").text(),d=n.find(".mprm-data-carbohydrates").text(),u=n.find(".mprm-data-fat").text(),l=n.find(".mprm-data-protein").text(),p=n.find(".mprm-data-bulk").text(),_=n.find(".mprm-data-size").text(),f=n.find(".mprm-data-weight").text(),g=e("#edit-"+r);g.find('.inline-price [name="price"]').val(i),g.find('.inline-sku [name="sku"]').val(a),g.find('[name="nutritional[calories][val]"]').val(o),g.find('[name="nutritional[cholesterol][val]"]').val(m),g.find('[name="nutritional[fiber][val]"]').val(s),g.find('[name="nutritional[sodium][val]"]').val(c),g.find('[name="nutritional[carbohydrates][val]"]').val(d),g.find('[name="nutritional[fat][val]"]').val(u),g.find('[name="nutritional[protein][val]"]').val(l),g.find('[name="attributes[bulk][val]"]').val(p),g.find('[name="attributes[size][val]"]').val(_),g.find('[name="attributes[weight][val]"]').val(f)})}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Menu-Category",function(e){"use strict";function t(){return{init:function(){e("#IconPicker").fontIconPicker({source:e.fnt_icons_categorized,emptyIcon:!0,hasSearch:!0}).on("change",function(){}),e(".remove_icon_button").on("click",function(){e(this).siblings(".mprm_icon_p").find("input").attr({value:""})}),e(".upload_image_button").on("click",function(){return n.openUploadWindow(),!1}),e(".remove_image_button").on("click",function(){return e("#menu_category_thumbnail img").attr("src",e("#menu_category_thumbnail img").attr("data-placeholder")),e("#menu_category_thumbnail_id").val(""),e(".remove_image_button").hide(),!1})},openUploadWindow:function(){if(void 0===this.window){this.window=wp.media.frames.menu_itemable_file=wp.media({title:window.mprm_admin_vars.choose_image,button:{text:window.mprm_admin_vars.use_image},multiple:!1});var t=this;this.window.on("select",function(){var n=t.window.state().get("selection").first().toJSON();e("#menu_category_thumbnail_id").val(n.id),e("#menu_category_thumbnail img").attr("src",n.sizes.thumbnail.url),e(".remove_image_button").show()})}this.window.open()}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Theme",function(e){"use strict";function t(){return{init:function(){e(".mprm-item-gallery").magnificPopup({delegate:"a",type:"image",tLoading:"Loading image #%curr%...",mainClass:"mfp-img-mobile",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.',titleSrc:function(e){return e.el.attr("title")}},zoom:{enabled:!0,duration:300}})},viewParams:function(e,t){switch(t){case"simple-list":e.find(".mprm-widget-feat_img").addClass("hidden"),e.find(' select.mprm-widget-categ_name option[value="with_img"]').change("only_text").addClass("hidden"),e.find(".mprm-widget-price_pos").removeClass("hidden");break;case"grid":case"list":default:e.find(".mprm-widget-feat_img").removeClass("hidden"),e.find(' select.mprm-widget-categ_name option[value="with_img"]').change("only_text").removeClass("hidden"),e.find(".mprm-widget-price_pos").addClass("hidden")}},customizeWidget:function(){e.each(e(".mprm-widget-view"),function(t,r){var i=e(this).parents(".widget-content"),a=e(this).val();n.viewParams(i,a)}),e(document.body).on("change",".mprm-widget-view",function(){var t=e(this).parents(".widget-content"),r=e(this).val();n.viewParams(t,r)})}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),function(e){"use strict";e(document).ready(function(){"mp_menu_item"===e(window.post_type).val()&&MP_RM_Registry._get("Menu-Item").init(),"edit-mp_menu_item"===window.pagenow&&MP_RM_Registry._get("Menu-Item").quickEdit(),"restaurant-menu_page_mprm-settings"===window.pagenow&&MP_RM_Registry._get("Menu-Settings").init(),"restaurant-menu_page_mprm-customers"===window.pagenow&&MP_RM_Registry._get("Menu-Settings").delete_checked(),"edit-mp_menu_category"===window.pagenow&&MP_RM_Registry._get("Menu-Category").init(),"mprm_order"===e(window.post_type).val()&&MP_RM_Registry._get("Order").init(),e(".mprm-add-to-cart").length&&MP_RM_Registry._get("Menu-Shop").addToCart(),e("#mprm_checkout_wrap").length&&MP_RM_Registry._get("Menu-Shop").purchaseForm(),e("#mprm_purchase_form").length&&(MP_RM_Registry._get("Menu-Shop").loadGateway(),MP_RM_Registry._get("Menu-Shop").changeGateway(),MP_RM_Registry._get("Menu-Shop").update_item_quantities(),MP_RM_Registry._get("Menu-Shop").showTerms(),MP_RM_Registry._get("Menu-Shop").get_login(),MP_RM_Registry._get("Menu-Shop").loginAjax()),MP_RM_Registry._get("Menu-Shop").removeFromCart(),e(".mprm-widget-view").length&&MP_RM_Registry._get("Theme").customizeWidget(),e(".mprm-item-gallery").length&&MP_RM_Registry._get("Theme").init()})}(jQuery);
